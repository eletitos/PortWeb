var contenedor=document.getElementById("contenedor"),numeroFotos=datos.length,extension,numeroColumnas,anchoContenedor,anchoColumnas,arrayMinimos=[],imagen,primerScroll=!0,botonMenu=document.getElementById("menu-icon"),scrollPosition=0,modoMosaico=!0,aleatorio,dispositivoMovil=!1,about=document.getElementById("btn-about"),aboutDesplegado=!1,menu=document.querySelector("header nav"),cortina,cortinaRoja=document.querySelector(".cortina-roja"),iconosRedes=document.querySelectorAll(".iconos-redes"),textoAbout=document.querySelector(".texto-about"),email=document.querySelector(".texto-about").querySelector(".mail"),imgn,caja,videos,playIcon='<svg class="play-icon" viewBox="0 0 250 250" alt="Play video"><circle cx="125" cy="125" r="100" fill="none"  stroke-width="35" stroke="#fff"/><polygon points="95, 80 95, 170 170, 125" fill="#fff"/></svg>',hojaEstilo=document.styleSheets[1],cssSize=hojaEstilo.cssRules.length,comprobarInfoDesplegada=!1;document.oncontextmenu=function(){return!1},insertarReglaCss(),crearGaleria(),calcularColumnas(),calculoPosicion();for(let i=0;i<datos.length;i++)cortina[i].innerHTML=`<h3 class="titulo"> ${datos[i].titulo}</h3><span class="etiquetas">${datos[i].etiqueta}</span>`;window.addEventListener("resize",function(){calcularColumnas(),calculoPosicion()}),window.addEventListener("touchstart",function(){dispositivoMovil=!0;for(let i=0;i<imagen.length;i++)imagen[i].addEventListener("click",clickImagen)});for(let i=0;i<imagen.length;i++)imagen[i].addEventListener("mouseenter",function(){if(!dispositivoMovil){let objetoDesplazado;this.querySelector(".cortina").classList.add("cortina-info"),(this.querySelector("img")||this.querySelector("video")).classList.add("efecto-desplazamiento")}}),imagen[i].addEventListener("mouseleave",function(){if(!dispositivoMovil){let objetoDesplazado;this.querySelector(".cortina").classList.remove("cortina-info"),(this.querySelector("img")||this.querySelector("video")).classList.remove("efecto-desplazamiento")}});function clickImagen(){console.log(this.querySelector(".cortina")),this.querySelector(".cortina").classList.toggle("cortina-info")}function calculoPosicion(){arrayMinimos=[];for(let n=0;n<numeroColumnas;n++)arrayMinimos.push(0);for(let i=0;i<imagen.length;i++){var minimo=Math.min.apply(null,arrayMinimos),index=arrayMinimos.indexOf(minimo),posicionEjeX=index*anchoColumnas*anchoContenedor/100;imagen[i].style.left=posicionEjeX+"px",imagen[i].style.top=minimo+"px",arrayMinimos[index]=minimo+imagen[i].offsetHeight}var maximo=Math.max.apply(null,arrayMinimos);contenedor.style.height=maximo+"px"}function calcularColumnas(){let alturaInfo,desplazamiento;anchoContenedor=contenedor.offsetWidth,anchoColumnas=100/(numeroColumnas=anchoContenedor<501?1:anchoContenedor<1001?2:anchoContenedor<1501?3:4),imagen.forEach(function(value,index){imagen[index].style.width=anchoColumnas+"%"}),fijarAlturaInfo(Math.round(anchoContenedor/numeroColumnas*.3),Math.round(anchoContenedor/numeroColumnas*.1))}function tamaÃ±oMaximoFotos(selector){let alturaMaxima=menu.offsetHeight;(imgn=selector.querySelector("video")||selector.querySelector("img")).style.maxWidth=anchoContenedor+"px",imgn.style.maxHeight=alturaMaxima+"px",imgn.style.width="auto"}function crearGaleria(){for(let i=0;i<numeroFotos;i++){(caja=document.createElement("div")).className="imagen";let archivo=datos[i].archivo,extension,elemento;elemento="mp4"===archivo.split(".")[1]?`<video loop onloadedmetadata="calculoPosicion()" muted autoplay playsinline src="../videos/video500px/${archivo}" poster="../videos/video500px/poster/poster${i+1}.jpg"></video>`:`<img src="../img/portfolio/${archivo}" onload="calculoPosicion()" alt="Elena Titos. ${datos[i].alt}. ${datos[i].titulo}">`,contenedor.appendChild(caja),caja.innerHTML=`<div class="contenedor-cortina"> ${elemento} <div class="cortina"></div> </div>`}imagen=document.querySelectorAll(".imagen"),cortina=document.querySelectorAll(".cortina"),videos=document.querySelectorAll("video"),sinAutoplay()}function sinAutoplay(){setTimeout(function(){videos.forEach(function(val,index){let tiempo;if(0===videos[index].currentTime){val.parentElement.insertAdjacentHTML("beforeend",playIcon);let botonPlay=val.parentElement.querySelector(".play-icon");botonPlay.addEventListener("click",function(e){e.stopPropagation(),val.play()}),val.onplaying=function(){botonPlay.style.display="none"}}})},1500)}function clickImagen(){let objetoDesplazado;this.scrollIntoView({behavior:"smooth",block:"center"}),this.querySelector(".cortina").classList.toggle("cortina-info"),(this.querySelector("img")||this.querySelector("video")).classList.toggle("efecto-desplazamiento"),comprobarInfoDesplegada=!0}function insertarReglaCss(){hojaEstilo.insertRule(".cortina-info{height: 0;}",cssSize),hojaEstilo.insertRule(".efecto-desplazamiento{transform: translateY(-57px); -webkit-transform: translateZ(0);}",cssSize+1)}function fijarAlturaInfo(alto,desplazamiento){hojaEstilo.cssRules[cssSize].style.height=`${alto}px`,hojaEstilo.cssRules[cssSize+1].style.transform=`translateY(${-desplazamiento}px)`}window.addEventListener("scroll",function(){botonMenu.checked||!modoMosaico?window.scrollTo(0,scrollPosition):primerScroll&&numeroColumnas>1&&(window.innerWidth>1400||screen.orientation.type.includes("portrait"))&&(window.scrollTo(0,0),document.querySelector(".caja-cabecera").classList.add("recogida"),document.querySelector(".pie").classList.add("pie-desplegado"),setTimeout(function(){primerScroll=!1},900))}),document.body.addEventListener("touchmove",function(){botonMenu.checked||!modoMosaico?document.body.style.overflow="hidden":document.body.style.overflow="auto",comprobarInfoDesplegada&&imagen.forEach(function(val){let elementoDesplazado;val.querySelector(".cortina").classList.remove("cortina-info"),(val.querySelector("img")||val.querySelector("video")).classList.remove("efecto-desplazamiento"),comprobarInfoDesplegada=!1})}),botonMenu.addEventListener("change",function(){if(scrollPosition=window.scrollY,aboutDesplegado){cortinaRoja.classList.replace("desplegado","replegado"),textoAbout.classList.replace("desplegado-texto","replegado-texto");for(let i=0;i<iconosRedes.length;i++)iconosRedes[i].classList.remove("mostrar")}}),about.addEventListener("click",function(){cortinaRoja.classList.remove("replegado"),cortinaRoja.classList.add("desplegado"),textoAbout.classList.replace("replegado-texto","desplegado-texto");for(let i=0;i<iconosRedes.length;i++)iconosRedes[i].classList.add("mostrar");aboutDesplegado=!0}),email.addEventListener("mouseenter",function(){document.oncontextmenu=function(){return!0}}),email.addEventListener("mouseleave",function(){document.oncontextmenu=function(){return!1}});